# Calibrated_Geographically_Weighted_Ridge_Regression
This program is craeted on top of the on top of mgwr: A Python implementation of multiscale geographically weighted regression for investigating process spatial heterogeneity and scale [1], while adjusting the way the spatial interaction between the OD-flow entities is accounted for in the model. In mgwr, the entities accounted for in the model are either points or polygons, with single pair of coordinates, thus, the d_{ij} is typically the Euclidean distance. In our OD-flow implementation, we adapt the pair-wise spatial weighting protocol in the GWR model according to the spatial flow interaction introduced in Kordi et al. (2016) and “associated with two geographic locations, an origin and a destination” [2]. Thus, in our pair-wise spatial weighting of AAWD OD-flow, each entity encompasses a four-dimensional vector of coordinates (x_i,\ y_i,\ {x\prime}_i,\ {y\prime}_i) as shown in Figure 65. The pair-wise weight is then formulized. The final hyperparameter in the model is the bandwidth, which is crucial for the KNN implementation of the model. As we have no prior knowledge on the extent of the spatial heterogenous behavior in the system, the model’s bandwidth is calibrated using the default mgwr “golden search optimization routine and a corrected Akaike information criterion AICc”. This optimization routine guarantees the model’s parsimony as it searches for the bandwidth corresponding to minimum AICc, consequently “penalizes smaller bandwidths”, as can be understood from the AICc formula.
[1] Oshan, T.M.; Li, Z.; Kang, W.; Wolf, L.J.; Fotheringham, A.S. mgwr: A Python Implementation of Multiscale Geographically Weighted Regression for Investigating Process Spatial Heterogeneity and Scale. ISPRS Int. J. Geo-Inf. 2019, 8, 269. https://doi.org/10.3390/ijgi8060269
[2]  Maryam Kordi & A. Stewart Fotheringham (2016) Spatially Weighted Interaction Models (SWIM), Annals of the American Association of Geographers, 106:5, 990-1012, DOI: 10.1080/24694452.2016.1191990 
